<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	th:replace="~{layout/common-layout :: commonLayout(~{this::head},~{this::main} )}">
<head>
<link rel="stylesheet" href="/css/members/list.css">
<script src="/js/department.js"></script>
<link rel="stylesheet" href="/css/department/side.css" />

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- jQuery를 포함하려면 위의 코드를 사용하세요 -->

    <script>
        $(document).ready(function () {
            $('#up-depart').change(function () {
                var selectedDept = $(this).val();
                filterMembersByDept(selectedDept);
            });

            // 선택한 부서에 따라 멤버를 필터링하는 함수
            function filterMembersByDept(department) {
                $.ajax({
                    type: 'POST',
                    url: '/members/filterByDepartment', // 실제 엔드포인트에 맞게 URL 변경
                    data: { department: department },
                    success: function (result) {
                        // result가 멤버의 JSON 배열이라고 가정하고, 테이블을 업데이트
                        updateMemberTable(result);
                    },
                    error: function (xhr, status, error) {
                        console.error(error);
                    }
                });
            }

            // 필터링된 데이터로 멤버 테이블을 업데이트하는 함수
            function updateMemberTable(filteredMembers) {
                var tbody = $('#members-table tbody');
                tbody.empty();

                $.each(filteredMembers, function (index, member) {
                    var row = '<tr>' +
                        '<td class="a">' + member.no + '</td>' +
                        '<td class="b">' + member.name + '</td>' +
                        '<td class="c">' + member.rank + '</td>' +
                        '<td class="d">' + member.dept + '</td>' +
                        '<td class="e">' + member.phone + '</td>' +
                        '<td class="f">' + member.joinCompanyDate + '</td>' +
                        '<td class="g">' + member.resignationDate + '</td>' +
                        '</tr>';
                    tbody.append(row);
                });
            }
        });
    </script>


</head>
<body>
	<main class="warp-main">
		<div th:replace="~{department/side :: side}"></div>
		<div class="main">
			<div class="title">
				<h1>사원조회/삭제/수정</h1>
			</div>
			<div class="search">
				<label for="name">부서명</label>
					<select name="parentName" id="up-depart" class="custom-select">
						<option class="option" th:each="name : ${names}" th:text="${name}"></option>
				</select>
				<label for="name" class="label2" id="center">재직상태</label>
					<select class="custom-select">
							<option class="option" >재직</option>
							<option class="option" >퇴사</option>
					</select>
				<button class="search-button"></button>	
			</div>
			
			<table>
				<thead>
					<tr >
						<td class="a">사번</td>
						<td class="b">이름</td>
						<td class="c">직급</td>
						<td class="d">부서</td>
						<td class="e">전화번호</td>
						<td class="d">입사일</td>
						<td class="f">퇴사일</td>
				
					</tr>
				</thead>
				<tbody>
					<tr th:each="members:${list}">
						<td class="a" th:text="${members.no}"></td>
						<td class="b" th:text="${members.name}"></td>
						<td class="c" th:text="${members.rank}"></td>
						<td class="d" th:text="${members.dept}"></td>
						<td class="e" th:text="${members.phone}"></td>
						<td class="f" th:text="${members.joinCompanyDate}"></td>
						<td class="g" th:text="${members.resignationDate}"></td>
					</tr>

					<tr>
						<td class="a">240119</td>
						<td class="b">이예슬</td>
						<td class="c">대리</td>
						<td class="d">관리부</td>
						<td class="e">010-2561-4981</td>
						<td class="f">2024.01.19</td>
						<td class="g">2024.01.19</td>
					</tr>
					

				</tbody>
			</table>
		</div>
	</main>
	
</body>

</html>