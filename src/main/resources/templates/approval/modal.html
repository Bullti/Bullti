<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
	<div class="approval-modal" th:fragment="modal">
		<div class="modal-bady">
			<h3>결재선 설정</h3>
			<div class="flex modal-content">

				<div class="de-form">
					<ul class="depart">
						<li th:each="dept : ${deptList}" th:if="${dept.parentId == 0}">
							<span class="clickable" onclick="getEmployee(this)">[[${dept.deptName}]]</span>
							<ul>
								<li th:each="subDept : ${dept.child}"><span
									class="clickable" onclick="getEmployee(this)">[[${subDept.deptName}]]</span>
									<ul>
										<li th:each="subsubDept : ${subDept.child}"><span
											class="clickable" onclick="getEmployee(this)">[[${subsubDept.deptName}]]</span>
										</li>
									</ul></li>
							</ul>
						</li>
					</ul>
				</div>
				<div class="em-form"></div>
				<div class="btn-form flex col center">
					<img src="/img/right-arrow.png" onclick="addAproval()"> <img
						src="/img/left-arrow.png" onclick="removeAproval()">
				</div>
				<div class="re-form">
					<div class="title">
						<h3>결재</h3>
					</div>
					<div class="wrap">
					</div>
				</div>
			</div>
			<div class="btn-area flex center">
				<button onclick="approval_line()">확인</button>
				<button onclick="btn_approval()">취소</button>
			</div>
		</div>
		<script>
			function btn_approval() {
				var modal = $('.approval-modal');
				modal.css('display', modal.css('display') === 'none' ? 'flex'
						: 'none');
			}
		</script>
		<script type="text/javascript">
		 function approval_line() {
			    var empArr = [];
			 
		        var inputValues = $(".re-form .wrap p input");
		        for(let i=0; i<inputValues.length; i++){
		        	empArr.push($(inputValues[i]).val());
		        }
		        
		        $.ajax({
		            type: "POST",
		            url: "/approval/line",
		            data: {emps: empArr},
		            dataType: "json",
		            success: function(data) {
		                // Ajax 요청이 성공한 후에 실행되는 로직
		                btn_approval();
		            },
		            error: function(error) {
		                console.error("Ajax 요청 중 에러 발생:", error);
		            }
		        });
		    };
		</script>
	</div>
</body>
</html>
